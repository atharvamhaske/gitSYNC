/*! For license information please see content.js.LICENSE.txt */
(()=>{function e(){var t,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function a(e,o,i,c){var a=o&&o.prototype instanceof l?o:l,u=Object.create(a.prototype);return n(u,"_invoke",function(e,n,o){var i,c,a,l=0,u=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return i=e,c=0,a=t,d.n=n,s}};function p(e,n){for(c=e,a=n,r=0;!f&&l&&!o&&r<u.length;r++){var o,i=u[r],p=d.p,m=i[2];e>3?(o=m===n)&&(a=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=p&&((o=e<2&&p<i[1])?(c=0,d.v=n,d.n=i[1]):p<m&&(o=e<3||i[0]>n||n>m)&&(i[4]=e,i[5]=n,d.n=m,c=0))}if(o||e>1)return s;throw f=!0,n}return function(o,u,m){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&p(u,m),c=u,a=m;(r=c<2?t:a)||!f;){i||(c?c<3?(c>1&&(d.n=-1),p(c,a)):d.n=a:d.v=a);try{if(l=2,i){if(c||(o="next"),r=i[o]){if(!(r=r.call(i,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,c<2&&(c=0)}else 1===c&&(r=i.return)&&r.call(i),c<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((r=(f=d.n<0)?a:e.call(n,d))!==s)break}catch(e){i=t,c=1,a=e}finally{l=1}}return{value:r,done:f}}}(e,i,c),!0),u}var s={};function l(){}function u(){}function f(){}r=Object.getPrototypeOf;var d=[][i]?r(r([][i]())):(n(r={},i,function(){return this}),r),p=f.prototype=l.prototype=Object.create(d);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,n(e,c,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=f,n(p,"constructor",f),n(f,"constructor",u),u.displayName="GeneratorFunction",n(f,c,"GeneratorFunction"),n(p),n(p,c,"Generator"),n(p,i,function(){return this}),n(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:a,m}})()}function n(e,t,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}n=function(e,t,r,o){function c(t,r){n(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[t]=r:(c("next",0),c("throw",1),c("return",2))},n(e,t,r,o)}function t(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return r(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,c=e},f:function(){try{a||null==t.return||t.return()}finally{if(s)throw c}}}}function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function o(e,n,t,r,o,i,c){try{var a=e[i](c),s=a.value}catch(e){return void t(e)}a.done?n(s):Promise.resolve(s).then(r,o)}function i(e){return function(){var n=this,t=arguments;return new Promise(function(r,i){var c=e.apply(n,t);function a(e){o(c,r,i,a,s,"next",e)}function s(e){o(c,r,i,a,s,"throw",e)}a(void 0)})}}var c={javascript:"js",typescript:"ts",python:"py",python3:"py",java:"java","c++":"cpp",c:"c","c#":"cs",ruby:"rb",swift:"swift",go:"go",golang:"go",scala:"scala",kotlin:"kt",rust:"rs",php:"php",dart:"dart",racket:"rkt",erlang:"erl",elixir:"ex",mysql:"sql",mssql:"sql",oracle:"sql",postgresql:"sql"},a=null,s=!1,l=null,u=Date.now(),f=null;function d(){return p.apply(this,arguments)}function p(){return(p=i(e().m(function n(){return e().w(function(e){for(;;)switch(e.n){case 0:return console.log("GitSync: Content script loaded on LeetCode"),u=Date.now(),e.n=1,y();case 1:m();case 2:return e.a(2)}},n)}))).apply(this,arguments)}function m(){var e=new MutationObserver(function(e){var n,r=!1,o=t(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("childList"===i.type&&i.addedNodes.length>0){var c,a=t(i.addedNodes);try{for(a.s();!(c=a.n()).done;){var f,d=c.value;if(1===d.nodeType&&(((null===(f=d.textContent)||void 0===f?void 0:f.toLowerCase())||"").includes("accepted")||d.querySelector('[data-e2e-locator="submission-result"]')||d.querySelector('[class*="submission-result"]'))){r=!0,u=Date.now();break}}}catch(e){a.e(e)}finally{a.f()}if(r)break}}}catch(e){o.e(e)}finally{o.f()}r&&(l&&clearTimeout(l),l=setTimeout(function(){!function(){if(!(s||Date.now()-u>3e4)){for(var e=!1,n=0,r=['[data-e2e-locator="submission-result"]','div[class*="submission-result"]','div[class*="result-container"]'];n<r.length;n++){var o,i=r[n],c=t(document.querySelectorAll(i));try{for(c.s();!(o=c.n()).done;){var a=o.value,f=a.textContent.trim().toLowerCase();if(f.includes("accepted")&&f.length<100&&(f.includes("runtime")||f.includes("memory")||a.querySelector('[class*="runtime"]')||a.querySelector('[class*="memory"]'))){e=!0;break}}}catch(e){c.e(e)}finally{c.f()}if(e)break}e&&(l&&clearTimeout(l),l=setTimeout(function(){s||function(){g.apply(this,arguments)}()},2e3))}}()},2e3))});e.observe(document.body,{childList:!0,subtree:!0})}function y(){return v.apply(this,arguments)}function v(){return(v=i(e().m(function n(){var t,r;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,new Promise(function(e){chrome.storage.local.get(["syncedSubmissions"],function(n){e(n.syncedSubmissions||{})})});case 1:t=e.v,f=t,console.log("GitSync: Loaded",Object.keys(f).length,"synced submissions from cache"),e.n=3;break;case 2:e.p=2,r=e.v,console.log("GitSync: Could not load synced submissions cache:",r),f={};case 3:return e.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function g(){return(g=i(e().m(function n(){var t,r,o,i,c,l,u,d,p,m;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!s){e.n=1;break}return e.a(2);case 1:if(t=x()){e.n=2;break}return console.log("GitSync: Could not extract problem info"),e.a(2);case 2:if(!(!t.name||/^\d+$/.test(t.name)||t.name.length<2)){e.n=4;break}if(console.warn("GitSync: Problem name is invalid:",t.name,"- extracting from URL"),!((r=S())&&r.length>0)){e.n=3;break}t.name=r,console.log("GitSync: Updated problem name from URL:",r),e.n=4;break;case 3:return console.error("GitSync: Could not extract valid problem name, aborting sync"),s=!1,e.a(2);case 4:for(o=0,i=0;i<t.code.length;i++)c=t.code.charCodeAt(i),o=(o<<5)-o+c,o&=o;if(l="".concat(t.name,"-").concat(t.language,"-").concat(Math.abs(o)),a!==l){e.n=5;break}return console.log("GitSync: Duplicate submission detected (same session), skipping sync"),e.a(2);case 5:if(!f||!f[l]){e.n=6;break}return console.log("GitSync: Submission already synced (found in cache), skipping"),a=l,e.a(2);case 6:return e.p=6,e.n=7,new Promise(function(e){chrome.storage.local.get(["syncedSubmissions"],function(n){e(n.syncedSubmissions||{})})});case 7:if(u=e.v,f=u,!u[l]){e.n=8;break}return console.log("GitSync: Submission already synced (found in storage), skipping"),a=l,e.a(2);case 8:e.n=10;break;case 9:e.p=9,p=e.v,console.log("GitSync: Could not check synced submissions storage:",p);case 10:return e.p=10,e.n=11,new Promise(function(e){chrome.storage.local.get(["githubToken","repoUrl","onboardingComplete"],function(n){e(n)})});case 11:if(!((d=e.v).onboardingComplete&&d.githubToken&&d.repoUrl)){e.n=13;break}return e.n=12,h(d.githubToken,d.repoUrl,t);case 12:if(!e.v){e.n=13;break}return console.log("GitSync: File already exists in GitHub, skipping sync"),a=l,f||(f={}),f[l]=Date.now(),chrome.storage.local.set({syncedSubmissions:f}),e.a(2);case 13:e.n=15;break;case 14:e.p=14,m=e.v,console.log("GitSync: Could not check GitHub for existing file:",m);case 15:return e.n=16,w();case 16:if(e.v){e.n=17;break}return console.log("GitSync: Onboarding not complete, skipping sync"),e.a(2);case 17:console.log("GitSync: Detected accepted submission:",t),s=!0,a=l;try{f||(f={}),f[l]=Date.now(),chrome.storage.local.set({syncedSubmissions:f})}catch(e){console.log("GitSync: Could not store synced submission:",e)}chrome.runtime.sendMessage({type:"SYNC_SOLUTION",problem:t},function(e){var n;setTimeout(function(){s=!1},3e3),e&&e.success?(console.log("GitSync: Successfully synced to GitHub"),C("Solution synced to GitHub!","success")):(console.error("GitSync: Failed to sync:",null==e?void 0:e.error),null!=e&&null!==(n=e.error)&&void 0!==n&&n.includes("does not match")||C("Failed to sync: "+((null==e?void 0:e.error)||"Unknown error"),"error"))});case 18:return e.a(2)}},n,null,[[10,14],[6,9]])}))).apply(this,arguments)}function h(e,n,t){return b.apply(this,arguments)}function b(){return(b=i(e().m(function n(t,r,o){var i,c,a,s,l,u,f,d;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,i=r.match(/github\.com\/([^\/]+)\/([^\/]+)/)){e.n=1;break}return e.a(2,!1);case 1:return c=i[1],a=i[2].replace(/\.git$/,""),s=function(e){return e&&"string"==typeof e?(e=e.trim(),/^\d+$/.test(e)?"solution":e.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,function(e,n){return n.toUpperCase()}).replace(/^./,function(e){return e.toLowerCase()}).replace(/[^a-zA-Z0-9]/g,"")||"solution"):"solution"}(o.name)+"."+o.extension,l=o.difficulty.toLowerCase(),u="".concat(l,"/").concat(s),e.n=2,fetch("https://api.github.com/repos/".concat(c,"/").concat(a,"/contents/").concat(u),{headers:{Authorization:"token ".concat(t),Accept:"application/vnd.github.v3+json"}});case 2:return f=e.v,e.a(2,f.ok);case 3:return e.p=3,d=e.v,console.log("GitSync: Error checking GitHub file existence:",d),e.a(2,!1)}},n,null,[[0,3]])}))).apply(this,arguments)}function S(){var e=window.location.pathname.match(/\/problems\/([^\/]+)/);return e?e[1].split("-").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}).join(" "):null}function w(){return new Promise(function(e){chrome.storage.local.get(["onboardingComplete"],function(n){e(!0===n.onboardingComplete)})})}function x(){try{var e=function(){for(var e=0,n=['[data-cy="question-title"]','div[class*="question-title"]','h1[class*="title"]','h2[class*="title"]','h3[class*="title"]','h4[class*="title"]','a[href*="/problems/"]','div[class*="title"]','span[class*="title"]'];e<n.length;e++){var r,o=n[e],i=t(document.querySelectorAll(o));try{for(i.s();!(r=i.n()).done;){var c=r.value.textContent.trim();if(c&&!/^\d+$/.test(c)){var a=c.replace(/^\d+\.\s*/,"");if(a=a.replace(/\s+\d+$/,""),!(/^\d+$/.test(a)||a.length<2)&&!a.includes("/")&&!a.includes("http")&&/[a-zA-Z]/.test(a)&&a.length>0&&a.length<100)return console.log("GitSync: Extracted problem name:",a),a}}}catch(e){i.e(e)}finally{i.f()}}var s=window.location.pathname.match(/\/problems\/([^\/]+)/);if(s){var l=s[1].split("-").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}).join(" ");return console.log("GitSync: Extracted problem name from URL:",l),l}return console.error("GitSync: Could not extract problem name"),null}(),n=function(){for(var e=0,n=['[class*="difficulty"]','[class*="text-olive"]','[class*="text-yellow"]','[class*="text-pink"]','[class*="text-green"]','[class*="text-orange"]'];e<n.length;e++){var t=n[e],r=document.querySelector(t);if(r){var o=r.textContent.toLowerCase();if(o.includes("easy"))return"Easy";if(o.includes("medium"))return"Medium";if(o.includes("hard"))return"Hard"}}return document.querySelector('[class*="text-olive"], [class*="easy"]')?"Easy":document.querySelector('[class*="text-yellow"], [class*="medium"]')?"Medium":document.querySelector('[class*="text-pink"], [class*="hard"]')?"Hard":"Medium"}(),r=function(){for(var e=0,n=['button[id*="lang"]','[class*="lang-select"]','button[class*="rounded"][class*="flex"]'];e<n.length;e++){var r,o=n[e],i=t(document.querySelectorAll(o));try{for(i.s();!(r=i.n()).done;){var a=r.value.textContent.toLowerCase().trim();if(c[a])return a}}catch(e){i.e(e)}finally{i.f()}}var s=k();if(s){if(s.includes("func ")&&s.includes("package"))return"go";if(s.includes("def ")&&s.includes(":"))return"python3";if(s.includes("public class")||s.includes("class Solution"))return"java";if(s.includes("function")||s.includes("=>"))return"javascript";if(s.includes("fn ")&&s.includes("impl"))return"rust";if(s.includes("#include"))return"c++"}return"javascript"}(),o=k(),i=c[r.toLowerCase()]||r.toLowerCase();return e&&o?{name:e,difficulty:n,language:r,code:o,extension:i}:null}catch(e){return console.error("GitSync: Error extracting problem info:",e),null}}function k(){var e=document.querySelector('[class*="monaco-editor"]');if(e){var n=e.querySelectorAll(".view-line");if(n.length>0)return Array.from(n).map(function(e){return e.textContent}).join("\n")}var t=document.querySelectorAll(".view-lines .view-line");if(t.length>0)return Array.from(t).map(function(e){return e.textContent}).join("\n");var r=document.querySelector(".CodeMirror");if(r&&r.CodeMirror)return r.CodeMirror.getValue();var o=document.querySelector("textarea");return o&&o.value?o.value:""}function C(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=document.getElementById("gitsync-notification");t&&t.remove();var r=document.createElement("div");r.id="gitsync-notification",r.style.cssText="\n    position: fixed;\n    bottom: 20px;\n    right: 20px;\n    padding: 12px 20px;\n    background: ".concat("success"===n?"#000":"#dc2626",";\n    color: #fff;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    font-size: 14px;\n    border-radius: 4px;\n    z-index: 10000;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n    animation: slideIn 0.3s ease;\n  "),r.textContent=e;var o=document.createElement("style");o.textContent="\n    @keyframes slideIn {\n      from { transform: translateX(100%); opacity: 0; }\n      to { transform: translateX(0); opacity: 1; }\n    }\n  ",document.head.appendChild(o),document.body.appendChild(r),setTimeout(function(){r.style.animation="slideIn 0.3s ease reverse",setTimeout(function(){return r.remove()},300)},4e3)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d()})();